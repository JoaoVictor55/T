\chapter{Trabalhos correlatos}

A aplicação de métodos para a detecção de arritmias não é uma ideia nova. Conforme \citeonline{moody2001}, desde a década de 60, 
havia estudos que buscavam desenvolver algoritmos para a análise de arritmias. \citeonline{SAFDAR2024107908}, aponta algumas técnicas
clássicas utilizadas como \textit{Support Vector Machine (SVM)} , \textit{K-nearest neighbor (KNN)} e \textit{Random Forest}.

Os autores mostram que nos últimos anos técnicas de \textit{deep learning}, redes neurais, vem ganhando tração. Muito por dispensar ou depender menos intensamente
de \textit{features} manuais, podendo aprende-las automaticamente. Dentre as primeiras técnicas usadas está as redes \textit{feed-forward}, seguido pelas
CNN e LSTM, além de abordagens híbridas.

A presente seção apresenta uma revisão de alguns trabalhos voltados a aplicação de modelos de aprendizado de máquina para a detecção
de arritmias cardíacas. 

\citeonline{chazal2004} propuseram um método automático para classificação de arritmias nas cinco classes definidas pela AAMI (descritas na seção \ref{sub_sec:padroes_arritmias_aami}), utilizando o banco de dados MIT-BIH. O classificador empregado foi o discriminante linear, um método estatístico paramétrico baseado na suposição de distribuição Gaussiana dos dados.

A metodologia incluiu etapas de pré-processamento, extração de features e classificação. Foram avaliadas diferentes configurações e estratégias de particionamento, incluindo a tradicional (intrapaciente) e a proposta pelos autores (interpaciente, com os conjuntos Ds1 e Ds2 descritos em \ref{sec:particionamento}). O estudo demonstrou que a partição intrapaciente gera resultados otimistas e não representa adequadamente a capacidade de generalização do modelo.

O pré-processamento aplicava filtros de mediana e passa-baixa para remoção do baseline wander. Em seguida, as features foram extraídas a partir de duas abordagens principais: (i) janelas fixas centradas no pico R e (ii) janelas adaptadas à duração do batimento, considerando o complexo QRS e a onda T. Também foram utilizadas medidas temporais, como duração do QRS, intervalos RR e presença da onda P.

A melhor configuração encontrada combinava features segmentadas com janela temporal flexível, intervalos RR, presença da onda P e durações do QRS e da onda T — todas extraídas sem escalar o sinal —, processadas por dois discriminantes lineares independentes, um para cada derivação do MIT-BIH. Essa abordagem obteve desempenho superior às demais e se tornou referência para estudos posteriores.

Apesar dos bons resultados, o método depende fortemente da qualidade das features e do pré-processamento, sendo sensível à variação morfológica entre pacientes — um ponto que trabalhos mais recentes, baseados em aprendizado profundo, buscam superar.

\citeonline{Mousavi2018InterAI}, 2019, propuseram um modelo baseado em \textit{encoder-decoder} para a classificação de cada batimento em uma sequência (\textit{sequence-to-sequence}, ou seq2seq). 
O pré-processamento consiste na normalização do sinal, segmentação em batimentos individuais e reamostragem para 280 amostras, sem o uso de filtros para remoção de ruídos. 
O modelo foi avaliado nas partições interpaciente e intrapaciente, utilizando os conjuntos Ds1 e Ds2.

A arquitetura é composta por uma sub-rede convolucional com três camadas contendo 32, 64 e 128 filtros, responsável pela extração inicial das \textit{features}. 
As representações obtidas alimentam o \textit{encoder}, que codifica a sequência em uma nova representação latente, utilizada pelo \textit{decoder} para gerar uma sequência de classificações. 
Tanto o \textit{encoder} quanto o \textit{decoder} são implementados com LSTM bidirecionais, de modo que a rede processa a sequência de entrada em ambas as direções — direta e reversa.

Para lidar com o desbalanceamento das classes, os autores aplicaram a técnica \textit{SMOTE} (\textit{Synthetic Minority Oversampling Technique}) para gerar amostras sintéticas apenas no conjunto de treinamento, 
aumentando a representatividade das classes minoritárias sem afetar os dados de validação e teste.


Em \citeonline{Zhang2021InterpatientEH}, é proposta uma rede neural convolucional profunda para a classificação de arritmias nas cinco classes definidas pela AAMI. Os autores enfatizam a importância de o modelo aprender características invariantes entre pacientes, de modo a melhorar sua capacidade de generalização. Enquanto outros trabalhos — como este TCC — buscam que o modelo aprenda essas características diretamente a partir dos dados, Zhang et al. propuseram uma estratégia adversarial para induzir esse comportamento.

A arquitetura é composta por um encoder, responsável por extrair as características mais relevantes da entrada, seguido por dois ramos:
um classificador, que prevê o tipo de batimento, e uma rede adversária, que tenta identificar a qual paciente o batimento pertence.
A função de perda é baseada na cross-entropy (uma generalização da BCE para múltiplas classes) e é modificada de forma a maximizar a perda da rede adversária enquanto minimiza a do classificador.

Esses dois objetivos são conflitantes: quanto melhor a rede adversária for em identificar o paciente, menor será a invariância das features aprendidas. Assim, um hiperparâmetro 
\textit{k} é introduzido para controlar o trade-off entre a generalização (obtida ao maximizar a perda adversária) e o desempenho de classificação (que tende a cair quando o modelo foca apenas em padrões gerais).

A entrada do modelo consiste em batimentos individuais e em razões entre intervalos RR: a razão entre o pré-RR e a média dos pré-RR da gravação, e a razão entre o pré-RR e o pré-RR mais próximo. Os autores destacam que o intervalo pré-RR tem alta capacidade discriminativa para distinguir batimentos ventriculares e supraventriculares de batimentos normais — ainda que, isoladamente, não seja suficiente para separar esses dois tipos de arritmia entre si.

%intrapaciente
Em \citeonline{kiranyaz2016real}, foi proposto um leve modelo de classificação de arritmias baseado em CNN (ver Seção~\ref{sec:fundamentos_cnn}). Os autores seguiram o particionamento intra-paciente com cinco minutos de treinamento específico — oriundo do conjunto ds2 — e treinamento global a partir de amostras aleatórias do conjunto ds1. Os dados de treino totais somam menos de 1\% dos batimentos totais. 

A AAMI define que dados de pacientes específicos não podem ultrapassar cinco minutos; regra seguida pelos autores.

Não foi utilizado engenharia de features, empregando apenas o sinal crú em duas entradas: uma com o batimento segmentado e uma outra com três sequências de batimentos; para fornecer contexto temporal. Em ambos os casos os autores utilizaram 64 ou 128 amostras, sendo que no primeiro caso, a perda de desempenho foi insignificante. O modelo é formado por três camadas convolucionais modificadas, isto é, elas fazem tanto a convolução quanto o \textit{downsampling}, e duas camadas de perceptrons.

No trabalho, os autores destacam a leveza do modelo, justificando que a partição usada dispensa o uso de redes profundas e o uso de engenharia de features.

Em \citeonline{saadatnejad2020}, foi proposto um modelo baseado em redes LSTM (ver Seção~\ref{sec:fundamentos_rnn}) para a classificação de arritmias voltado a dispositivos móveis. 
Com o objetivo de atender às restrições computacionais de sistemas embarcados, os autores desenvolveram uma arquitetura composta por dois modelos simples que realizam 
classificações independentes, seguidos por uma rede neural artificial (ANN) responsável pela decisão final.

A entrada do modelo consiste em batimentos cardíacos segmentados utilizando uma janela temporal fixa, 
características extraídas via transformada \textit{wavelet} de Daubechies de ordem dois, e intervalos RR, conforme sugerido por \citeonline{chazal2004}. 
O sistema é dividido em dois submodelos, denominados \(\alpha\) e \(\beta\). 
O primeiro (\(\alpha\)) possui dois ramos de LSTM: um recebe o sinal reamostrado (\textit{downsampled}) concatenado com os intervalos RR, 
enquanto o outro recebe o sinal combinado com as características \textit{wavelet}. 
Já o segundo submodelo (\(\beta\)) é composto por duas camadas LSTM, recebendo como entrada os componentes principais do sinal, 
concatenados com as características \textit{wavelet} e os intervalos RR. 
Em ambos os casos, a saída das LSTM é conectada a uma camada totalmente conectada (FC, \textit{Fully Connected}) para a classificação.

O treinamento foi conduzido sob uma divisão \textit{intrapaciente}, na qual foi desenvolvido um modelo especialista para cada indivíduo. 
De acordo com as recomendações da AAMI, os autores separaram os dados em conjuntos locais e globais: 
os dados locais corresponderam aos cinco primeiros minutos dos registros dos pacientes do conjunto Ds2, 
enquanto o conjunto global foi composto pelo conjunto Ds1 completo. 
Para teste, utilizou-se o restante do conjunto Ds2, excluindo os minutos empregados no treinamento.

Por se tratar de um modelo voltado a dispositivos vestíveis — e, portanto, de uso pessoal —, essa divisão não constitui necessariamente um vazamento de dados, 
embora o viés de sobreposição entre indivíduos permaneça. Assim, é importante considerar esse aspecto ao comparar os resultados com trabalhos que adotam a divisão \textit{interpaciente}.

De modo geral, observa-se que os trabalhos diferem amplamente em suas escolhas 
metodológicas — desde o tipo de particionamento (intrapaciente ou interpaciente), 
passando pela inclusão ou não de \textit{features} manuais, até o uso de arquiteturas 
simples, híbridas ou profundas. Essas diferenças dificultam comparações diretas de desempenho, 
mas permitem identificar tendências metodológicas importantes que orientam o desenvolvimento 
de modelos mais robustos e generalizáveis, como os abordados neste TCC.

Na tabela \ref{tab:metodologia_trabalhos} é resumido a abordagem dos trabalhos apresentados incluído a utilizada neste TCC.

\input{includes/revisao_literatura_tabela_metodos}